<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- InstanceBegin template="/Templates/mcv_guide.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!-- InstanceBeginEditable name="doctitle" -->
<title>Save the Display</title>
<!-- InstanceEndEditable --><!-- InstanceBeginEditable name="head" --><!-- InstanceEndEditable -->
<link rel="stylesheet" href="/mcidas/doc/mcv_guide/mcidasv.css" charset="ISO-8859-1" type="text/css">
<!-- InstanceBeginEditable name="CurrentFile" -->
<script language="javascript" type="text/javascript">
function setParentPage() { if (parent.setPage) parent.setPage('misc/Scripting/SaveDisplay.html',true); }
</script>
<!-- InstanceEndEditable -->
<style type="text/css">
<!--
.style1 {font-size: large;}
.style2 {font-size: small;}
-->
</style>
</head>
<body onLoad="setParentPage();">
<div class="TopTitleNav">
  <p class="style2" style="text-align:left; "> [<!-- InstanceBeginEditable name="GoToPrevious" --><a href="ModifyLayerObject.html">Go
        to Previous</a><!-- InstanceEndEditable -->] <span style="padding-left: 15px; "> [<!-- InstanceBeginEditable name="GoToNext" --><a href="Environment.html">Go
        to Next</a><!-- InstanceEndEditable -->] </span> </p>
  <hr align="center">
</div>
<!-- InstanceBeginEditable name="MainContent" -->
<div class="pagetitle">Save the Display</div>
<p><strong><a name="captureImage" id="captureImage"></a>captureImage -</strong></strong> Writes
  panel display to a file</p>
<div class="OneTabIndent">Usage:<em> panel[0].captureImage(keywords)</em></div>
<div class="TwoTabIndent">Keywords - required:</div>
<div class="ThreeTabIndent2"><table class="noborder">
    <tr>
      <td valign="top">file=</td>
      <td>name of file, file format determined by file extension; valid options: .jpg, .gif, .png, .ps, .pdf, .svg, .kml, and .kmz<!---, .pdf, .svg, .kml, .kmz---></td>
    </tr>
</table></div>
<div class="TwoTabIndent">Keywords - optional:</div>
<div class="ThreeTabIndent2"><table class="noborder">
    <tr>
      <td valign="top">height=</td>
      <td>height of image (default - see Remarks)</td>
    </tr>
    <tr>
      <td valign="top">width=</td>
      <td>width of image (default - see Remarks)</td>
    </tr>
    <tr>
      <td valign="top">quality=</td>
      <td>quality of jpg file (0.0 to 1.0); default=1.0;    not used with other formats</td>
    </tr>
    <tr>
      <td valign="top">bgtransparent=</td>
      <td>captures image with transparent background; default=False</td>
    </tr>
    <tr>
      <td valign="top">formatting=</td>
      <td>various formatting options to apply to the output image</td>
    </tr>
  </table></div>
<ul class="propertylist">
  <li class="propertylistitem">There are a variety of keywords that can be passed through the keyword parameter of captureImage. Below is a list of these formatting keywords and options for each of them. See the second example below for an example of passing various formatting options through captureImage with a dictionary.</li>
  <ul class="propertylist">
  <li class="propertylistitem"><strong>Clip -</strong> Clips the output image at a specific latitude/longitude location or at specific spacing into the image. By default, no clipping is done.</li>
    <ul class="propertylist">
      <li class="propertylistitem"><strong>north -</strong> Sets the north latitude to clip the image at.</li>
      <li class="propertylistitem"><strong>south -</strong> Sets the south latitude to clip the image at.</li>
      <li class="propertylistitem"><strong>east -</strong> Sets the east longitude to clip the image at.</li>
      <li class="propertylistitem"><strong>west -</strong> Sets the west longitude to clip the image at.</li>
      <li class="propertylistitem"><strong>space -</strong> Sets a pixel spacing in each direction to clip into the image.<br>Example: <em>space=-50</em><br>
      Clips 50 pixels into the image in all four directions.</li>
      <li class="propertylistitem"><strong>hSpace -</strong> Sets a pixel spacing in the vertical to clip into the image.<br>
        Example: <em>hSpace=50</em><br>
        Clips 50 pixels into the image in both vertical directions (top and bottom).</li>
      <li class="propertylistitem"><strong>vSpace -</strong> Sets a pixel spacing in the horizontal to clip into the image.<br>
        Example: <em>vSpace=20</em><br>
        Clips 20 pixels into the image in both horizontal directions (left and right).</li>
    </ul>
  <li class="propertylistitem"><strong>Colorbar -</strong> Adds a colorbar to the output image. By default, no colorbar is added to the image.</li>
    <ul class="propertylist">
      <li class="propertylistitem"><strong>display -</strong> Sets the display to add the colorbar for. This is the name given to the layer at createLayer.</li>
      <li class="propertylistitem"><strong>width -</strong> Sets the horizontal width of the colorbar in pixels.</li>
      <li class="propertylistitem"><strong>height -</strong> Sets the vertical height of the colorbar in pixels.</li>
      <li class="propertylistitem"><strong>orientation -</strong> Sets the location of the tickmarks and labels with respect to the colorbar. Valid options for this keyword are &quot;top&quot;, &quot;bottom&quot;, &quot;left&quot;, and &quot;right&quot;. Default=&quot;bottom&quot;.</li>
      <li class="propertylistitem"><strong>tickmarks -</strong> Sets the number of tickmarks and labels to add to the colorbar. By default, no tickmarks or labels are added to the colorbar.</li>
      <li class="propertylistitem"><strong>interval -</strong> Sets the numerical interval to use between tickmarks and labels on the colorbar. By default, no tickmarks or labels are added to the colorbar.</li>
      <li class="propertylistitem"><strong>values -</strong> Sets specific numerical values to use for tickmarks and labels on the colorbar. By default, no tickmarks or labels are added to the colorbar.</li>
      <li class="propertylistitem"><strong>place -</strong> Sets the location the colorbar on the image along with x and y pixel offsets.  Valid options are:<br>
<table class="noborder">
    <tr>
      <td width="150"><strong>UL -</strong> Upper Left</td>
      <td width="150"><strong>UM -</strong> Upper Middle</td>
      <td width="150"><strong>UR -</strong> Upper Right</td>
    </tr>
    <tr>
      <td width="150"><strong>ML -</strong> Middle Left</td>
      <td width="150"><strong>MM -</strong> Middle Middle</td>
      <td width="150"><strong>MR -</strong> Middle Right</td>
    </tr>
    <tr>
      <td width="150"><strong>LL -</strong> Lower Left</td>
      <td width="150"><strong>LM -</strong> Lower Middle</td>
      <td width="150"><strong>LR -</strong> Lower Right</td>
    </tr>
  </table>
  Example: <em>place=&quot;LM,0,-30&quot;</em><br>
  Places the colorbar in the lower middle and raises it 30 pixels from the bottom of the image.<br>
  Example: <em>place=&quot;ML,50,0&quot;</em><br>
  Places the colorbar in the middle left and indents it 50 pixels from the left of the image.</li>
      <li class="propertylistitem"><strong>anchor -</strong> Sets the location on the colorbar to center at the <strong>place</strong>. Valid options are:<br>
      <table class="noborder">
    <tr>
      <td width="150"><strong>UL -</strong> Upper Left</td>
      <td width="150"><strong>UM -</strong> Upper Middle</td>
      <td width="150"><strong>UR -</strong> Upper Right</td>
    </tr>
    <tr>
      <td width="150"><strong>ML -</strong> Middle Left</td>
      <td width="150"><strong>MM -</strong> Middle Middle</td>
      <td width="150"><strong>MR -</strong> Middle Right</td>
    </tr>
    <tr>
      <td width="150"><strong>LL -</strong> Lower Left</td>
      <td width="150"><strong>LM -</strong> Lower Middle</td>
      <td width="150"><strong>LR -</strong> Lower Right</td>
    </tr>
  </table>
  Example: <em>anchor="UM"</em><br>
  Sets the upper middle of the colorbar to be centered at the <strong>place</strong> specified.</li>
      <li class="propertylistitem"><strong>ShowLines -</strong> Includes lines on the colorbar at the tickmark and label locations. Valid options are &quot;true&quot; and &quot;false&quot;. Default=&quot;false&quot;.</li>
      <li class="propertylistitem"><strong>showUnit</strong> - Includes a unit with the numerical labels on the colorbar. Valid options are &quot;true&quot; and &quot;false&quot;. Default=&quot;false&quot;.</li>
      <li class="propertylistitem"><strong>suffix -</strong> Sets a label for the numerical labels on the colorbar. Note that this cannot be used in conjunction with <strong>showUnit</strong>.<br>
      Example: <em>suffix="H"</em><br>
      Sets the labels on the colorbar to be "H".</li>
      <li class="propertylistitem"><strong>suffixFrequency -</strong> Sets which labels on the colorbar will show the unit or suffix. Valid options are &quot;first&quot;, &quot;last&quot;, and &quot;all&quot;. Default=&quot;last&quot;.</li>
      <li class="propertylistitem"><strong>color -</strong> Sets the colors of the labels and lines. Default=&quot;black&quot;.<br>
      </li>
      <li class="propertylistitem"><strong>lineColor -</strong> Sets the color of the lines on the colorbar, assuming<strong> ShowLines</strong> is set to true. Default=<strong>color</strong> or &quot;black&quot; if <strong>color</strong> has not been set.</li>
    </ul>
  <li class="propertylistitem"><strong>ImageOverlay -</strong> Adds an image, such as a logo, to the output image.</li>
    <ul class="propertylist">
      <li class="propertylistitem"><strong>image -</strong> Specifies the image to add to the output image.</li>
      <li class="propertylistitem"><strong>place -</strong> Sets the location of the image along with x and y pixel offsets.  Valid options are:<br>
      <table class="noborder">
    <tr>
      <td width="150"><strong>UL -</strong> Upper Left</td>
      <td width="150"><strong>UM -</strong> Upper Middle</td>
      <td width="150"><strong>UR -</strong> Upper Right</td>
    </tr>
    <tr>
      <td width="150"><strong>ML -</strong> Middle Left</td>
      <td width="150"><strong>MM -</strong> Middle Middle</td>
      <td width="150"><strong>MR -</strong> Middle Right</td>
    </tr>
    <tr>
      <td width="150"><strong>LL -</strong> Lower Left</td>
      <td width="150"><strong>LM -</strong> Lower Middle</td>
      <td width="150"><strong>LR -</strong> Lower Right</td>
    </tr>
  </table>
  Example: <em>place=&quot;UL,20,20&quot;</em><br>
  Adds the image to the upper left brought down 20 pixels from the top and brought in 20 pixels from the left.</li>
      <li class="propertylistitem"><strong>anchor -</strong> Sets the location on the image to center at the <strong>place</strong>. Valid options are:<br>
      <table class="noborder">
    <tr>
      <td width="150"><strong>UL -</strong> Upper Left</td>
      <td width="150"><strong>UM -</strong> Upper Middle</td>
      <td width="150"><strong>UR -</strong> Upper Right</td>
    </tr>
    <tr>
      <td width="150"><strong>ML -</strong> Middle Left</td>
      <td width="150"><strong>MM -</strong> Middle Middle</td>
      <td width="150"><strong>MR -</strong> Middle Right</td>
    </tr>
    <tr>
      <td width="150"><strong>LL -</strong> Lower Left</td>
      <td width="150"><strong>LM -</strong> Lower Middle</td>
      <td width="150"><strong>LR -</strong> Lower Right</td>
    </tr>
  </table>
  Example: <em>anchor="UM"</em><br>
  Sets the upper middle of the image to be centered at the <strong>place</strong> specified.</li>
      <li class="propertylistitem"><strong>transparency -</strong> Sets the transparency of the image. The valid values range from 0 to 1, 0 being completely opaque and 1 being 100% transparent. Default=0.</li>
      </ul>
  <li class="propertylistitem"><strong>Matte -</strong> Adds a matte to the output image.  By default, no matte is added to the image.</li>
    <ul class="propertylist">
      <li class="propertylistitem"><strong>Background -</strong> Sets the background color of the matte.  Default="white"</li>
      <li class="propertylistitem"><strong>top -</strong> Sets the size of the matte on the top of the image. Default=0.<br>
      Example: <em>top=20</em><br>
      Adds a 20 pixel matte to the top of the image.</li>
      <li class="propertylistitem"><strong>bottom -</strong> Sets the size of the matte on the bottom of the image.  Default=0.<br>
      Example: <em>bottom=20</em><br>
      Adds a 20 pixel matte to the bottom of the image.</li>
      <li class="propertylistitem"><strong>left -</strong> Sets the size of the matte on the left of the image.  Default=0.<br>
      Example: <em>left=50</em><br>
      Adds a 50 pixel matte to the left of the image.</li>
      <li class="propertylistitem"><strong>right -</strong> Sets the size of the matte on the right of the image. Default=0.<br>
      Example: <em>right=50</em><br>
      Adds a 50 pixel matte to the right of the image.</li>
      <li class="propertylistitem"><strong>space -</strong> Sets the size of the matte on all sides of the image.  Default=0.<br>
      Example: <em>space=25</em><br>
      Adds a 25 pixel matte to all sides of the image.</li>
      <li class="propertylistitem"><strong>hSpace -</strong> Sets the size of the matte on the left and right sides of the image.  Default=0.<br>
      Example: <em>hspace=10</em><br>
      Adds a 10 pixel matte to the left and right sides of the image.</li>
      <li class="propertylistitem"><strong>vSpace -</strong> Sets the size of the matte on the top and bottom of the image.<br>
      Example: <em>vspace=20</em><br>
      Adds a 20 pixel matte to the top and bottom of the image.</li>
    </ul>
  <li class="propertylistitem"><strong>Resize -</strong> Resizes the output image. By default, no resize is done to the output image, and the image will be the same size as the display window.</li>
    <ul class="propertylist">
      <li class="propertylistitem"><strong>dimensions -</strong> Sets the size of the output image in either a pixel count or a percentage of the display window.<br>
      Example: <em>dimensions=("400","300")</em><br>
      Creates a 400x300 pixel image.<br>
      Example: <em>dimensions=("60%","80%")</em><br>
      Creates an image that is 60% in the x of the original display, and 80% in the y of the original display.</li>
    </ul>
  <li class="propertylistitem"><strong>TextOverlay -</strong> Adds text to the output image. By default, no text is added to the output image.</li>
    <ul class="propertylist">
      <li class="propertylistitem"><strong>text -</strong> Sets the text string to add to the output image.<br>
      Example: <em>text="GOES East Image"</em><br>
      Adds the text of "GOES East Image" to the output image.</li>
            <li class="propertylistitem"><strong>place -</strong> Sets the location of the text along with x and y pixel offsets.  Valid options are:<br>
      <table class="noborder">
    <tr>
      <td width="150"><strong>UL -</strong> Upper Left</td>
      <td width="150"><strong>UM -</strong> Upper Middle</td>
      <td width="150"><strong>UR -</strong> Upper Right</td>
    </tr>
    <tr>
      <td width="150"><strong>ML -</strong> Middle Left</td>
      <td width="150"><strong>MM -</strong> Middle Middle</td>
      <td width="150"><strong>MR -</strong> Middle Right</td>
    </tr>
    <tr>
      <td width="150"><strong>LL -</strong> Lower Left</td>
      <td width="150"><strong>LM -</strong> Lower Middle</td>
      <td width="150"><strong>LR -</strong> Lower Right</td>
    </tr>
  </table>
  Example: <em>place=&quot;UL,20,20&quot;</em><br>
  Adds the text to the upper left brought down 20 pixels from the top and brought in 20 pixels from the left.</li>
      <li class="propertylistitem"><strong>anchor -</strong> Sets the location on the text to center at the <strong>place</strong>. Valid options are:<br>
      <table class="noborder">
    <tr>
      <td width="150"><strong>UL -</strong> Upper Left</td>
      <td width="150"><strong>UM -</strong> Upper Middle</td>
      <td width="150"><strong>UR -</strong> Upper Right</td>
    </tr>
    <tr>
      <td width="150"><strong>ML -</strong> Middle Left</td>
      <td width="150"><strong>MM -</strong> Middle Middle</td>
      <td width="150"><strong>MR -</strong> Middle Right</td>
    </tr>
    <tr>
      <td width="150"><strong>LL -</strong> Lower Left</td>
      <td width="150"><strong>LM -</strong> Lower Middle</td>
      <td width="150"><strong>LR -</strong> Lower Right</td>
    </tr>
  </table>
  Example: <em>anchor="UM"</em><br>
  Sets the upper middle of the text string to be centered at the <strong>place</strong> specified.</li>
      <li class="propertylistitem"><strong>fontSize -</strong> Sets the size of the text.</li>
      <li class="propertylistitem"><strong>fontFace -</strong> Sets the font to use for the text.</li>
      <li class="propertylistitem"><strong>color -</strong> Sets the color of the text.</li>
      <li class="propertylistitem"><strong>background -</strong> Sets the background color for the text string.  By default, this is not defined and there is no background for the text.</li>
      <li class="propertylistitem"><strong>transparency -</strong> Sets the transparency of the text. The valid values range from 0 to 1, 0 being completely opaque and 1 being 100% transparent. Default=0.</li>
    </ul>
  <li class="propertylistitem"><strong>TransparentBackground -</strong> Sets the background of the image to be transparent in the output image. By default, the background is not transparent. To capture an image with a transparent background, specify <em>TransparentBackground()</em> in the <strong>formatting</strong> keyword of captureImage.</li>
</ul></ul>
<div class="OneTabIndent">Remarks:</div>
<div class="TwoTabIndent">If captureImage is used to save a panel that was created
  with openBundle, the sizes default to size of the display window when the bundle
  was saved. If data was loaded using createLayer, the sizes default to those
  defined in buildWindow.</div>
<div class="TwoTabIndent">If running in a foreground session, the image capture is created from the display on the monitor.  Therefore, the user is limited to a window size that fits within the bounds of the monitor.  Any windows created with buildWindow must also include the Main Toolbar and Viewpoint Toolbar buttons in the window.  Therefore, there is also a minimum size the display window can be.  If a user wishes to capture larger or smaller images in a foreground session, they must use <strong>setFullScreenWidth()</strong>, <strong>setFullScreenHeight()</strong>, and <strong>toggleFullScreen()</strong>.  The setFullScreen functions accept numerical pixel values. From the background, buildWindow can be used for any size display.</div>
<div class="ThreeTabIndent">Example of capturing a large image in a foreground session:</div>
<div class="FourTabIndent"><em>panel=buildWindow()</em></div>
<div class="FourTabIndent"><em>panel[0].setFullScreenWidth(1500)</em></div>
<div class="FourTabIndent"><em>panel[0].setFullScreenHeight(1350)</em></div>
<div class="FourTabIndent"><em>panel[0].toggleFullScreen()</em></div>
<div class="FourTabIndent"><em>panel[0].captureImage('C:\\Users\\myuser\\Image.gif'</em>)</div>
  <div class="OneTabIndent">Example without formatting:</div>
  <div class="TwoTabIndent"><em>panel[0].captureImage('C:\\Users\\myuser\\Image.png'</em>)</div>
  <div class="OneTabIndent">Example with formatting:</div>
  <div class="TwoTabIndent"><em>myFormatting = [</em></div>
    <div class="ThreeTabIndent"><em>Matte(</em></div>
      <div class="FourTabIndent"><em>bottom="80",</em></div>
      <div class="FourTabIndent"><em>top="80",</em></div>
      <div class="FourTabIndent"><em>space="100",</em></div>
    <div class="ThreeTabIndent"><em>),</em></div>
    <div class="ThreeTabIndent"><em>Colorbar(</em></div>
      <div class="FourTabIndent"><em>display=imLayer,</em></div>
      <div class="FourTabIndent"><em>place="ML,50,0",</em></div>
      <div class="FourTabIndent"><em>anchor="ML",</em></div>
      <div class="FourTabIndent"><em>orientation="left",</em></div>
      <div class="FourTabIndent"><em>interval="10",</em></div>
      <div class="FourTabIndent"><em>width="25",</em></div>
      <div class="FourTabIndent"><em>height="400",</em></div>
    <div class="ThreeTabIndent"><em>),</em></div>
    <div class="ThreeTabIndent"><em>ImageOverlay(</em></div>
      <div class="FourTabIndent"><em>image='C:\\Users\\myuser\\logo3.png',</em></div>
      <div class="FourTabIndent"><em>place="UR,-20,10",</em></div>
      <div class="FourTabIndent"><em>anchor="UR",</em></div>
    <div class="ThreeTabIndent"><em>),</em></div>
    <div class="ThreeTabIndent"><em>TextOverlay(</em></div>
      <div class="FourTabIndent"><em>text="GOES East Image",</em></div>
      <div class="FourTabIndent"><em>place="LM,0,-40",</em></div>
      <div class="FourTabIndent"><em>anchor="LM",</em></div>
      <div class="FourTabIndent"><em>fontSize="30",</em></div>
      <div class="FourTabIndent"><em>color="black",</em></div>
    <div class="ThreeTabIndent"><em>),</em></div>
  <div class="TwoTabIndent"><em>]</em></div>
  <div class="TwoTabIndent"><em>panel[0].captureImage('C:\\Users\\myuser\\formattingExample.gif',formatting=myFormatting)</em></div>
<p><strong><a name="writeMovie" id="writeMovie"></a>writeMovie -</strong> Writes
  an image sequence to a movie file (ISL function) <br>
<div class="OneTabIndent">Usage:<em> writeMovie(keywords) </em></div>
<div class="TwoTabIndent">Keywords - required:</div>
<div class="ThreeTabIndent2"><table class="noborder">
    <tr>
      <td valign="top">file=</td>
      <td>name of file, file format determined by file extension; valid options: .gif, .mov</td>
    </tr>
</table></div>
<div class="TwoTabIndent">Keywords - optional:</div>
<div class="ThreeTabIndent2"><table class="noborder">
<tr>
      <td valign="top">resize width= height=</td>
      <td>size of image (default = height of window)</td>
    </tr>
  </table></div>
<div class="OneTabIndent">Example:</div>
<div class="TwoTabIndent"><em>writeMovie('C:\\Users\\myuser\\movie.gif',params='resize width=600 height=800')</em></div>
<!-- InstanceEndEditable -->
<div class="BottomTitleNav">
  <hr align="center">
  <p class="style2" style="text-align:left; "> [<!-- InstanceBeginEditable name="GoToPrevious2" --><a href="ModifyLayerObject.html">Go
        to Previous</a><!-- InstanceEndEditable -->] <span style="padding-left: 15px; "> [<!-- InstanceBeginEditable name="GoToNext2" --><a href="Environment.html">Go
        to Next</a><!-- InstanceEndEditable -->] </span></p>
</div>
</body>
<!-- InstanceEnd -->
</html>